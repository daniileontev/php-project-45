#!/usr/bin/env php
<?php

$autoloadPath1 = __DIR__ . '/../../../autoload.php';
$autoloadPath2 = __DIR__ . '/../vendor/autoload.php';

if (file_exists($autoloadPath1)) {
    require_once $autoloadPath1;
} else {
    require_once $autoloadPath2;
}

function addition($num1, $num2)
{
    return $num1 + $num2;
}

function subtraction($num1, $num2)
{
    return $num1 - $num2;
}
function multiplication($num1, $num2): float|int
{
    return $num1 * $num2;
}

function generateNumber(): int
{
    return mt_rand(1, 25);
}

echo("Welcome to the Brain Games!\n");
echo("May I have your name? ");
$name = trim(fgets(STDIN));
echo "Hello, {$name}!\n";
echo ("What is the result of the expression?\n");

$correctAnswerCount = 0;

$isCorrect = true;
while ($isCorrect && $correctAnswerCount < 3) {

    if ($correctAnswerCount == 0) {
        $questionType = 1;
    } elseif ($correctAnswerCount == 1) {
        $questionType = 2;
    } elseif ($correctAnswerCount == 2) {
        $questionType = 3;
    }

    $numGenerator1 = generateNumber();
    $numGenerator2 = generateNumber();

    if ($questionType == 1) {
        $operator = '+';
        $correctAnswer = addition($numGenerator1, $numGenerator2);
    } elseif ($questionType == 2) {
        $operator = '-';
        $correctAnswer = subtraction($numGenerator1, $numGenerator2);
    } elseif ($questionType == 3) {
        $operator = '*';
        $correctAnswer = multiplication($numGenerator1, $numGenerator2);
    }

    echo("Question: {$numGenerator1} {$operator} {$numGenerator2}\n");
    $userAnswer = trim(fgets(STDIN));
    echo("Your answer: {$userAnswer}\n");

    if ($userAnswer == $correctAnswer) {
        echo "Correct!\n";
        $correctAnswerCount++;
    } else {
        echo "'{$userAnswer}' is wrong answer ;(. Correct answer was '{$correctAnswer}'\n";
        $isCorrect = false;
    }
    if ($correctAnswerCount === 3) {
    $isCorrect = false;
    echo "Congratulations, {$name}!\n";
    }
}

